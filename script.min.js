const canvas=document.getElementById("bg"),ctx=canvas.getContext("2d");function resizeCanvas(){canvas.width=window.innerWidth,canvas.height=window.innerHeight}resizeCanvas();let particlesArray=[],animationFrameId,isPageVisible=!0,frameCount=0;class Particle{constructor(){this.x=Math.random()*canvas.width,this.y=Math.random()*canvas.height,this.size=2.5*Math.random()+.8,this.speedX=.5-Math.random(),this.speedY=.5-Math.random(),this.opacity=.6*Math.random()+.2,this.originalOpacity=this.opacity,this.mouseX=null,this.mouseY=null}update(){this.x+=this.speedX,this.y+=this.speedY,(this.x>canvas.width||this.x<0)&&(this.speedX*=-1),(this.y>canvas.height||this.y<0)&&(this.speedY*=-1),this.opacity=this.originalOpacity+.1*Math.sin(.01*frameCount+.001*this.x),null!==this.mouseX&&null!==this.mouseY&&((dx=this.mouseX-this.x,dy=this.mouseY-this.y,(distance=Math.sqrt(dx*dx+dy*dy))<150)&&(angle=Math.atan2(dy,dx),force=.3*(1-distance/150),this.speedX+=.05*Math.cos(angle)*force,this.speedY+=.05*Math.sin(angle)*force))}draw(){ctx.fillStyle=`rgba(33, 0, 238, ${this.opacity})`,ctx.beginPath(),ctx.arc(this.x,this.y,this.size,0,2*Math.PI),ctx.fill(),ctx.shadowBlur=8,ctx.shadowColor=`rgba(0, 217, 102, ${.3*this.opacity})`}}function init(){particlesArray=[];for(let e=0;e<60;e++)particlesArray.push(new Particle)}function connect(){for(let e=0;e<particlesArray.length;e++)for(let t=e+1;t<particlesArray.length;t++){let a=particlesArray[e].x-particlesArray[t].x;Math.sqrt(a*a+(dy=particlesArray[e].y-particlesArray[t].y)*dy)<120&&(distance=Math.sqrt(a*a+dy*dy),ctx.strokeStyle=`rgba(30, 58, 138, ${.25*(1-distance/120)})`,ctx.lineWidth=1,ctx.beginPath(),ctx.moveTo(particlesArray[e].x,particlesArray[e].y),ctx.lineTo(particlesArray[t].x,particlesArray[t].y),ctx.stroke())}}function animate(){isPageVisible&&(ctx.clearRect(0,0,canvas.width,canvas.height),frameCount++,particlesArray.forEach(e=>{e.update(),e.draw()}),connect(),animationFrameId=requestAnimationFrame(animate))}init(),animate(),window.addEventListener("resize",()=>{resizeCanvas(),init()}),canvas.addEventListener("mousemove",e=>{particlesArray.forEach(t=>{t.mouseX=e.clientX,t.mouseY=e.clientY})}),canvas.addEventListener("mouseleave",()=>{particlesArray.forEach(e=>{e.mouseX=null,e.mouseY=null})}),document.addEventListener("visibilitychange",()=>{isPageVisible=!document.hidden,isPageVisible&&animate()});const transformationModal=document.getElementById("transformationModal"),transformBtn=document.getElementById("transformBtn"),transformationForm=document.getElementById("transformationForm"),successMessage=document.getElementById("successMessage");function openTransformModal(){transformationModal.classList.add("active"),document.body.style.overflow="hidden"}function closeTransformModal(){transformationModal.classList.remove("active"),document.body.style.overflow="auto",transformationForm.style.display="block",successMessage.style.display="none",transformationForm.reset()}function closeServices(){window.location.hash=""}function closeAbout(){window.location.hash=""}function closeBusinessProfile(){window.location.hash=""}function closeCapabilityStatement(){window.location.hash=""}function closeTechnicalCapabilities(){window.location.hash=""}function closePortfolio(){window.location.hash=""}function closeLegalRegulatory(){window.location.hash=""}transformationModal.addEventListener("click",e=>{e.target===transformationModal&&closeTransformModal()}),transformationForm.addEventListener("submit",e=>{e.preventDefault();const t=transformationForm.querySelector(".submit-btn"),a=t.textContent;t.textContent="Submitting...",t.disabled=!0,fetch(transformationForm.action,{method:"POST",body:new FormData(transformationForm),headers:{Accept:"application/json"}}).then(e=>{e.ok?(transformationForm.style.display="none",successMessage.style.display="block"):(alert("There was a problem submitting your form. Please try again."),t.textContent=a,t.disabled=!1)}).catch(e=>{console.error("Error:",e),alert("There was an error submitting your form. Please try again."),t.textContent=a,t.disabled=!1})});const observerOptions={threshold:.1,rootMargin:"0px 0px -100px 0px"},observer=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&(e.target.classList.add("animate-in"),observer.unobserve(e.target))})},observerOptions);document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll(".story-card, .card").forEach(e=>observer.observe(e))});